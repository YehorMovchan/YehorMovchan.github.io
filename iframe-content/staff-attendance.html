<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Відвідуваність працівника</title>
    <link rel="stylesheet" href="https://yehormovchan.github.io/static/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://yehormovchan.github.io/static/script.js"></script>
    <style>
        body{
            overflow-y: auto; 
            overflow-x: auto;
        }
        body::-webkit-scrollbar{
            display: inline;
            background-color: rgb(150, 170, 202);
            border-radius: 5px;
        }
        body::-webkit-scrollbar-thumb{
            background-color: rgb(93, 143, 209);
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>Відвідуваність працівника</h1>
    
    <div class="filter-menu">
        <label>Від: <input type="date" id="date-from"></label>
        <label>До: <input type="date" id="date-to"></label>
        <button id="filter-button">Застосувати</button>
    </div>
    
    <table border="1">
        <thead>
            <tr>
                <th>Дата</th>
                <th>Час початку</th>
                <th>Час закінчення</th>
                <th>Початок перерви</th>
                <th>Кінець перерви</th>
                <th>Додаткова інформація</th>
            </tr>
        </thead>
        <tbody id="attendance-table-body">
            <tr><td colspan="6">Виберіть діапазон дат для відображення даних</td></tr>
        </tbody>
    </table>
    
    <script>
        $(document).ready(function() {
            let urlParams = new URLSearchParams(window.location.search);
            let staffId = urlParams.get("id");
            
            $("#filter-button").click(function() {
                let dateFrom = $("#date-from").val();
                let dateTo = $("#date-to").val();
                
                if (staffId && dateFrom && dateTo) {
                    $.getJSON(`http://localhost:8080/attendance/staff/${staffId}/${dateFrom}/${dateTo}`, function(data) {
                        let tableBody = "";
                        if (data.length > 0) {
                            data.forEach(attendance => {
                                tableBody += `
                                    <tr>
                                        <td>${attendance.date}</td>
                                        <td>${attendance.start}</td>
                                        <td>${attendance.end}</td>
                                        <td>${attendance.breaktimeFrom || '-'}</td>
                                        <td>${attendance.breaktimeTo || '-'}</td>
                                        <td>${attendance.info || '-'}</td>
                                    </tr>
                                `;
                            });
                        } else {
                            tableBody = "<tr><td colspan='6'>Немає даних за обраний період</td></tr>";
                        }
                        $("#attendance-table-body").html(tableBody);
                    });
                } else {
                    alert("Будь ласка, виберіть діапазон дат");
                }
            });
        });
    </script>
</body>
</html>
